{
  "domain": {
    "mode": "netcdf",
    "varmap": {
      "dem": "dem",
      "d8": "d8",
      "cn": "cn",
      "channel_mask": "channel_mask",
      "x": "longitude",
      "y": "latitude"
    }
  },
  "domains": [
    {
      "name": "national_90m",
      "domain_nc": "domain_90m.nc",
      "output": { "out_netcdf": "flood_depth_90m.nc" },
      "restart": { "out": "restart_90m.nc" }
    },
    {
      "name": "regional_30m",
      "domain_nc": "domain_30m.nc",
      "output": { "out_netcdf": "flood_depth_30m.nc" },
      "restart": { "out": "restart_30m.nc" }
    },
    {
      "name": "city_10m",
      "domain_nc": "domain_10m.nc",
      "output": { "out_netcdf": "flood_depth_10m.nc" },
      "restart": { "out": "restart_10m.nc" }
    }
  ],
  "model": {
    "start_time": "2025-12-21T00:00:00Z",
    "T_s": 7200,
    "dt_s": 5,
    "encoding": "esri",
    "ia_ratio": 0.2,
    "particle_vol_m3": 0.25,
    "travel_time_s": 5,
    "travel_time_channel_s": 1,
    "travel_time_mode": "fixed",
    "travel_time_auto": {
      "hillslope_velocity_ms": 0.5,
      "channel_velocity_ms": 1.5,
      "min_s": 0.25,
      "max_s": 3600.0
    },
    "outflow_sink": true,
    "log_every": 10
  },
  "rain": {
    "schema": {
      "time_var": "time",
      "lat_var": "latitude",
      "lon_var": "longitude",
      "rain_var": "rain_rate",
      "crs_var": "crs",
      "time_units": "hours since 1900-01-01 00:00:0.0",
      "rate_units": "mm h-1",
      "require_cf": true,
      "require_time_dim": true
    },
    "sources": {
      "rain": {
        "kind": "netcdf",
      "path": "rain_time_dependent.nc",
      "var": "rain_rate",
      "time_var": "time",
      "select": "previous",
      "mode": "intensity_mmph",
      "weight": 1.0,
      "preload": true
    }
    }
  },
  "risk": {
    "enabled": true,
    "balance": 0.55,
    "p_low": 5.0,
    "p_high": 95.0
  },
  "restart": {
    "in": null,
    "out": "restart_state.nc",
    "every": 120,
    "strict_grid_check": true
  },
  "output": {
    "out_netcdf": "flood_depth.nc",
    "save_every_s": 0,
    "rotate_every_s": 0,
    "outflow_geojson": null,
    "Conventions": "CF-1.10",
    "title": "LPERFECT flood depth + hydrogeological risk index",
    "institution": "UniParthenope",
    "inundation_threshold_m": 0.01,
    "fill_value": -9999.0
  },
  "compute": {
    "device": "cpu",
    "mpi": {
      "enabled": true,
      "decomposition": "balanced",
      "min_rows_per_rank": 512,
      "balance": {
        "every_steps": 120,
        "every_sim_s": 0,
        "auto": true,
        "imbalance_threshold": 1.5
      }
    },
    "shared_memory": {
      "enabled": true,
      "workers": null,
      "min_particles_per_worker": 2000,
      "chunk_size": 16384
    }
  },
  "metrics": {
    "parallelization": {
      "enabled": false,
      "output": null,
      "max_samples": 256
    }
  }
}
